<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>贝米崔炜、姚坤杰还我血汗钱</title>
</head>
<body>
    <link rel="stylesheet" href="/themes/default/assets/css/style.css">
<style type="text/css">
*{
    margin: 0;
    padding:0;
}
html,body{
    height: 100%
}
#main,#main2{
    width: 100%;
    height: 100%
}
.con_div h6{
    padding-left: 40px;
    font-size: 14px;
    color: #fff;
}
</style>
<div style="display:none;"><img src="../images/xhq.png" alt=""></div>
<div class="wrap">

  <ul class="tabs group">
    <li><a class="active" href="javascript:;">总回款汇总</a></li>
    <li><a href="javascript:;">每日回款</a></li>
    <li><a href="javascript:;">态度观点</a></li>
  </ul>

  <div id="content">
    <div class="con_div" style="display: block;">
        <p class="top_txt">今日回款：<span id="todySpan">暂未公布</span>&nbsp;累计天数:<span id="allDay"></span>天</p>
        <ul class="txt_ul">
            <li>昨日回款</li>
            <li>总回款额</li>
            <li>累计回款</li>
            <li>百分比</li>
        </ul>
        <ul class="txt_ul" id="showUl">
            <li></li>
            <li>41.97亿</li>
            <li></li>
            <li></li>
        </ul>
    </div>
    <div class="con_div">
        <div id="main"></div>
    </div>
    <div class="con_div">
        <div class="cont_div">

            <h6>维权人士：</h6>
            <p class="normal_t" id="wqTxt">

            </p>
            <h6>其他人士：</h6>
            <p class="normal_t" id="qtTxt"></p>
        </div>
    </div>
  </div>

</div>



<script type="text/javascript" src="/themes/default/assets/js/echarts.common.min.js"></script>
<script type="text/javascript" src='/themes/default/assets/js/jquery-2.2.1.min.js'></script>
<script type="text/javascript">

function getOption(dateList,valueList){
    var option = {
        color: ['#3398DB'],
        title: {
            left: 'center',
            text: '每日回款数额',
            textStyle:{
                color:'#fff'
            }
        },
        tooltip: {
            trigger: 'axis'
        },
        xAxis: [ {
            data: dateList,
            nameTextStyle:{
                color:"#fff"
            },
            axisLine:{
                lineStyle:{
                    color:"#fff"
                }
            },
            axisLabel:{
                color:"#fff"
            }
            // gridIndex: 1
        }],
        yAxis: [ {
            splitLine: {show: false},
            axisLine:{
                lineStyle:{
                    color:"#fff"
                }
            },
            axisLabel:{
                color:"#fff"
            }
            // gridIndex: 1
        }],
        grid: [{
            left: '3%',
            right: '4%',
            bottom: '3%',
            containLabel: true
        }],
        series: [{
            type: 'line',
            showSymbol: false,
            data: valueList,
            // xAxisIndex: 1,
            // yAxisIndex: 1
        }]
    };
    return option;
}

$(function(){
$.ajax({
    'url':'/heim',
    'dataType':'json'
}).done(function(json){
    var option = getOption(json.dataList,json.moneyArr);
    var datalist = json.dataList;
    var moneyArr = json.moneyArr;
    console.log(datalist.length,moneyArr.length)
    for(var i = 0;i < moneyArr.length;i++){
        // saveData(datalist[i],moneyArr[i])
    }
    init(json,option,json.allCount,json.moneyArr,json.dataList)
    // datalist.forEach(function(item,index){
    //
    // })
})
// $.ajax({
//     'url':'/heim',
//     'dataType':'json'
// }).done(function(json){
//     initAdvice(json)
// })
function saveData(data,money){
    var data = {
        'date':data,
        'money':money
    }
    $.ajax({
        "type":"post",
        'url':'/getmoney',
        "data":data,
        "dataType":"json"
    }).done(function(json){
        console.log(json)
    }).fail(function(e){
        console.log(e)
    })
}

// var option1 = {
//     color: ['#3398DB'],
//     title: [{
//         left: 'center',
//         text: '每日回款数额',
//         textStyle:{
//             color:'#fff'
//         }
//     }],
//     tooltip : {
//         trigger: 'axis',
//         axisPointer : {            // 坐标轴指示器，坐标轴触发有效
//             type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
//         }
//     },
//     grid: {
//         left: '3%',
//         right: '4%',
//         bottom: '3%',
//         containLabel: true
//     },
//     xAxis : [
//         {
//             type : 'category',
//             data : dateList,
//             axisTick: {
//                 alignWithLabel: true
//             },
//             axisLabel:{
//                 color:"#fff"
//             },
//             axisLine:{
//                 lineStyle:{
//                     color:"#fff"
//                 }
//             }
//         }
//     ],
//     yAxis : [
//         {
//             type : 'value',
//             axisLabel:{
//                 color:"#fff"
//             },
//             axisLine:{
//                 lineStyle:{
//                     color:"#fff"
//                 }
//             }
//         }
//     ],
//     series : [
//         {
//             name:'回款',
//             type:'bar',
//             barWidth: '60%',
//             data:valueList
//         }
//     ]
// };
function initAdvice(allData){
    $('#wqTxt').html(allData.wqtxt);
    $('#qtTxt').html(allData.qttxt);
}

function init(option,allCount,moneyArr,dataList){

    $(".tabs li a").on('click',function(){
        var index = $(this).parent().index();
        $(".tabs li a").removeClass('active');
        $(this).addClass('active');
        $('#content .con_div').hide();
        $('#content .con_div').eq(index).show()
        if(index == 1){

            echarts.init(document.getElementById('main')).setOption(option);
        }
        if(index == 2){
            // echarts.init(document.getElementById('main2')).setOption(option1);
        }
    });
    if(moneyArr.length == dataList.length){
        $('#todySpan').text(moneyArr[moneyArr.length - 1] + '万');
        $('#showUl').find('li').eq(0).text(moneyArr[moneyArr.length - 2]+ ' 万')
    }else{
        $('#showUl').find('li').eq(0).text(moneyArr[moneyArr.length - 1]+ ' 万')
    }
    $('#allDay').text(dataList.length)
    $('#showUl').find('li').eq(2).text((allCount/10000).toFixed(4)+ ' 亿')
    $('#showUl').find('li').eq(3).text((allCount/4197).toFixed(2)+ ' %')
}
})
</script>
</body>
</html>
